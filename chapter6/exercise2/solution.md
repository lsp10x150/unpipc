При использовании единственной очереди с рис. 6.2 злоумышленник может испортить всю очередь, спамля ее запросами с идентификатором "1".
При использовании множества очередей на каждого клиента с рис. 6.3 злоумышленник не имеет доступа к очередям других клиентов. Использование значения IPC\_PRIVATE в качестве токена при создании новой очереди (msgget) всегда приводит к попытке создания новой очереди сообщений с ключом, который не совпадает со значением ключа ни одной из уже существующих очередей и не может быть получен с помощью функции ftok() ни при одной комбинации ее параметров.
